
let montaVistaSentences = [["Mr. DeRuiter is the best AP Computer Science Principles teacher here at Monta Vista*", 
                            "Mr. DeRuiter is the best AP Computer Science Principles teacher here at Monta Vista*", 
                            "Mr. DeRuiter is the best AP Computer Science Principles teacher here at Monta Vista*"],
                           ["My favorite part about AP Computer Science Principles is watching and taking notes on the Big Idea Videos. So far, our class has successfully completed Big Ideas 1-5. Collaborating with our tablemates to answer the questions and racing with them to get the right answers is such an adrenaline rush!*", 
                            "It’s incredible to see how many people have done well as a result of Monta Vista’s rigorous curriculum, guiding teachers, and support from peers. Although high school can be stressful, at the end of the day, working hard and being determined is what will get you  far.*", 
                            "The faculty at Monta Vista is dedicated and experienced, with over 90% of teachers holding advanced degrees. The school is committed to providing a safe and inclusive learning environment for all students, with a strong focus on promoting diversity, equity, and inclusion.*"],
                           ["Monta Vista is academically renowned with tons of great numbers: MVHS offers over 70 clubs and 40 sports teams, providing students with ample opportunities to get involved and pursue their passions. In 2021, 98% of MVHS graduates enrolled in a four-year college or university, with 62% attending top-ranked schools. MVHS is known for its strong STEM programs, including the award-winning robotics team and the nationally recognized Science Olympiad team.*", 
                            "Monta Vista High School is a prestigious public high school located in Cupertino, California. The school has a rich history dating back to its establishment in 1969. The student body at Monta Vista is diverse, with students from over 50 nationalities attending the school. With a student population of over 2,400, the school offers a wide range of academic and extracurricular programs.*",
                            "Monta Vista offers a comprehensive academic program with a wide range of Advanced Placement (AP) courses, honors courses, and elective courses. The school also offers an International Baccalaureate (IB) program, which allows students to earn an IB diploma. In addition to traditional courses, Monta Vista offers specialized programs that provide students with unique opportunities to explore specific career paths and gain hands-on experience in their field of interest.*"]
                          ];
let moviesSentences = [["The Godfather, widely considered to be one of the greatest movies ever made, features an iconic score by Nino Rota.*",
                        "The film's intricate plot, complemented by its masterful cinematography and evocative score, culminated in a poignant denouement that left audiences \
                        spellbound.*",
                        "Schindler’s list depicted the gruesome behavior by the Nazi’s on the Jewish population, leaving the audience with an unparalleled experience of being there \
                         without actually being there.*"],
                        ["In contemporary cinema, a plethora of trendy films are being produced, exuding a panoply of innovative themes and stylistic techniques that cater to the \
                         sophisticated tastes of modern audiences. From avant-garde arthouse productions to mainstream blockbuster spectacles, these films espouse a diverse range of \
                         esoteric concepts, replete with intricate subtextual messages and allegories that engage the discerning viewer.*", 
                         "Murder Mystery 2 is a thrilling whodunit film, starring Jennifer Aniston and Adam Sandler,  that grips the audience with its intricately woven plot, \
                          suspenseful pacing, and unexpected twists and turns. From the outset, the film immerses the viewer in a world of intrigue and deception, as a series of \
                          mysterious murders unfold, each one more perplexing than the last.*", 
                         "The Hunger Games movie is a cinematic masterpiece that has captivated audiences around the world with its dystopian vision, dynamic storytelling, and \
                          compelling characters. Set in a post-apocalyptic world where children are forced to fight to the death for the entertainment of the ruling elite, the film \
                          explores complex themes of power, survival, and the human spirit. The performances of the cast, led by Jennifer Lawrence in a career-defining role, are \
                          impeccable, imbuing their characters with a sense of authenticity and emotional depth that draws the viewer in.*"],
                        ["'Love, Actually' is the ultimate chick flick! It has 8 different storylines, 10 main characters, and 2 hours and 15 minutes of pure romantic bliss. \
                           With a star-studded cast including Hugh Grant, Emma Thompson, and Keira Knightley, this movie is a must-watch for any hopeless romantic! Plus, who can \
                           forget the iconic scene with the cue cards? It's a tear-jerker that will have you reaching for the tissues!*",
                         "'Murder on the Orient Express' is a gripping murder mystery that will keep you on the edge of your seat! With 12 suspects, 1 victim, and a train full of \
                          secrets, this Agatha Christie classic is a must-read for any mystery lover. Packed with twists and turns, the story will leave you guessing until the very \
                          end. And with a star-studded cast in the 2017 film adaptation, including Johnny Depp, Michelle Pfeiffer, and Judi Dench, the suspense is heightened even \
                          further.*",
                         "'Baahubali: The Beginning' is an epic Bollywood movie that broke all the records! With a budget of $24 million, it is the most expensive Indian film ever \
                           made. Directed by S. S. Rajamouli, it features breathtaking visuals, intense action sequences, and a captivating storyline. The film boasts a star-studded \
                           cast, including Prabhas, Rana Daggubati, and Tamannaah, and features impressive VFX effects. It became the highest-grossing Indian film of all time, \
                           earning over $92 million worldwide*"]
                         ];
let musicSentences = [["The tickets for the Drake concert are getting more and more expensive by the day. One ticket is costing more than $250!*",
                       "Despite the commercialization of the industry, music remains a powerful means of expression and a reflection of the human experience.*",
                       "Taylor Swift, Katy Perry, Miley Cyrus, and Ariana Grande are some of the most classic pop singers for the 2010s era.*"],
                      ["Autotune, a digital audio processor, has become a defining characteristic of pop and rap music in recent years. This technology has revolutionized the creative process for many artists, allowing them to experiment with different vocal styles that were previously impossible to achieve.*", 
                       "Over time, music has evolved and changed, with new instruments, genres, and styles emerging throughout history. The Western musical tradition, which includes classical music, opera, and musical theater, has its roots in medieval and Renaissance Europe. In the 20th century, jazz, rock, and pop music became popular, with artists changing the face of music forever.*",
                       "From intimate club shows to massive arena concerts, seeing your favorite artists perform live is an unforgettable experience. In fact, the live music industry was worth $24 billion in 2019! Attending concerts and festivals has become a huge part of many people's lives, with millions of music fans flocking to events around the world each year!*"],
                      ["Michael Jackson's Thriller is one of the best-selling albums of all time, with hits such as 'Beat It' and 'Billie Jean'. In mid-1983, Jackson persuaded Epic to reissue 'Thriller,' accompanied by a new music video. It peaked at #4 on the Billboard Hot 100 and #3 on the Billboard Hot Black Singles chart.*", 
                       "Streaming services like Spotify and Apple Music have revolutionized the way we consume music, and it's now easier than ever to discover new artists and genres. In fact, over 75,000 new songs are uploaded to Spotify every day! Social media platforms like TikTok have also had a huge impact on music trends, with viral challenges and dances helping to propel songs to the top of the charts.*",
                       "Students who participate in music programs are 52% more likely to attend college and have a 28% higher math proficiency score than those who don't! Despite these benefits, many schools have cut funding for music programs in recent years. In 2019, only 35% of elementary schools and 20% of middle schools offered music education in the United States. It's important to recognize the value of music education and support programs that give students the opportunity to learn and grow through music.*"]
                      ];
let mealsSentences = [["For my birthday, I want to eat at the Michelin Star Restaurant, Atelier Crenn, and pretend I’m a food critic. I want to taste the great flavors and experience the fancy ambiance.*",
                        "My go-to place to get brunch with my friends is Sweet Maple, where I love the vermont cheeseburger with tomato, shallot, romaine, and silky, smooth vermont white cheddar.*",
                        "I’m carving the creamy, cheesy, sauciness of Alfredo Pasta in my mouth. I love the aromatic smell and how the sauce melts into my mouth exploding into a richness of flavor.*"],
                      ["Chicken Tikka Masala is a popular Indian dish with marinated chicken in a creamy tomato-based sauce. It’s spiced with various Indian spices such as cumin, coriander, and garam masala, giving it a rich and complex flavor.*",
                       "Pad Thai is a delicious noodle dish from Thailand with a sweet and savory flavor, made with tamarind sauce, peanuts, and bean sprouts. My favorite Pad Thai is from Thai Bangkok, located at: 21670 Stevens Creek Blvd.*",
                       "Roughly 96% of American households purchase bananas at least once per month. A cluster of bananas, called a “hand,” consists of 10 to 20 individual bananas, also known as fingers. In fact, the word banana comes from banan, the Arabic word for 'finger'.*"],
                      ["With over 3 billion pizzas sold in the United States alone each year, it's safe to say that people can't get enough of this delicious dish. From classic pepperoni to veggie-loaded pies, there are countless toppings to choose from. did you know that the largest pizza ever made was 131 feet in diameter and weighed over 51,000 pounds?! That's a lot of pizza!*",
                       "There are many ways to enjoy coffee, from classic drip brews to frothy cappuccinos and lattes. And with the rise of specialty coffee shops, there are now more options than ever before! But did you know that the world's most expensive coffee, called Kopi Luwak, is made from coffee beans that have been eaten and excreted by a civet cat? It may sound strange, but this rare coffee can cost up to $600 per pound! Whether you take it black or with cream and sugar, coffee is a staple of daily life for many people.*",
                       "Let me teach you how to make the best avocado toast: 1) Start by mashing avocados in a glass container, along with adding black pepper, oregano, salt, and squeezing the juice of a half a lemon. 2) Toast two pieces of sourdough bread on the stove with an ample amount of butter. 3) Once your toast is golden brown spread the beautiful avocado mixture onto the toasts and top it with feta cheese and red chili flakes. 4) ENJOY!*"]
                      ];

let sentence;
var timer;
let numRounds = 0;

function goToNextPage(nextPage)
{
        window.location.href = nextPage;
        location.replace(nextPage);
}

function getCategoryLevels(category) {
        //https://www.w3schools.com/jsref/met_node_appendchild.asp
        let radioContainer = document.getElementById(category + "-container");
        radioContainer.innerHTML = "";

        let options = ["Easy", "Medium", "Hard"];

        for (let i = 0; i < options.length; i++) {
                let radio = document.createElement("input");
                radio.type = "radio";
                radio.name = "options";
                radio.value = options[i];
                radio.id = category + " " + options[i];
                radioContainer.appendChild(radio);

                let label = document.createElement("label");
                label.htmlFor = category + " " + options[i];
                label.innerHTML = options[i];
                radioContainer.appendChild(label);
        }
}

function checkButtons(categorybutton) {

        //https://www.geeksforgeeks.org/how-to-get-value-of-selected-radio-button-using-javascript/

        let isChecked = false;
        let index;
        let category;
        let level;

        for (let i = 0; i < categorybutton.length; i++) {

                if (categorybutton[i].checked) {

                        isChecked = true;
                        index = categorybutton[i].id.indexOf(" ");
                        category = categorybutton[i].id.substring(0,index);
                        level = categorybutton[i].id.substring(index+1);
                }
        }

        if (isChecked == false) {
                alert("You must choose a category!");
        }
        else {
                chooseSentence(category, level);
        }
}

function chooseSentence(category, level) {
        //parameters: category string and level string

        let sentenceOptions = []

        //setting the selected category to the current category
        localStorage.setItem("currentcategory", category);

        //choosing sentence options
        if (category == "montavista") {
                if (level == "Easy") {
                        sentenceOptions = montaVistaSentences[0];
                }
                else if (level == "Medium") {
                        sentenceOptions = montaVistaSentences[1];
                }
                else {
                        sentenceOptions = montaVistaSentences[2];
                }
        }
        else if (category == "music") {
                if (level == "Easy") {
                        sentenceOptions = musicSentences[0];
                }
                else if (level == "Medium") {
                        sentenceOptions = musicSentences[1];
                }
                else {
                        sentenceOptions = musicSentences[2];
                }
        }
        else if (category == "movies") {
                if (level == "Easy") {
                        sentenceOptions = moviesSentences[0];
                }
                else if (level == "Medium") {
                        sentenceOptions = moviesSentences[1];
                }
                else {
                        sentenceOptions = moviesSentences[2];
                }
        }
        else {
                if (level == "Easy") {
                        sentenceOptions = mealsSentences[0];
                }
                else if (level == "Medium") {
                        sentenceOptions = mealsSentences[1];
                }
                else {
                        sentenceOptions = mealsSentences[2];
                }
        }

        let sentenceOptionsStr = "";
        for (let i = 0; i < sentenceOptions.length; i++) {
                sentenceOptionsStr += sentenceOptions[i];
        }
        localStorage.setItem("sentenceOptions", sentenceOptionsStr);

        goToNextPage("gamePage.html");
}

function displaySentence() {

        let sentenceOptions = localStorage.getItem("sentenceOptions").split("*");
        let randomNum = Math.floor(Math.random()*3);
        sentence = sentenceOptions[randomNum];
        if (sentence.charAt(0) == ",") {
                sentence = sentence.substring(1);
        }
        document.getElementById("sentence").innerHTML = sentence;

        countPreferredCategory()
}

function countPreferredCategory() {
        //counting the number of times the current category has been played
        let currentCategory = localStorage.getItem("currentcategory");
        if (currentCategory == "montavista") {
                let numMontaVista = parseInt(localStorage.getItem("numMontaVista")) + 1;
                localStorage.setItem("numMontaVista", numMontaVista);
        }
        else if (currentCategory == "music") {
                let numMusic = parseInt(localStorage.getItem("numMusic")) + 1;
                localStorage.setItem("numMusic", numMusic);
        }
        else if (currentCategory == "movies") {
                let numMovies = parseInt(localStorage.getItem("numMovies")) + 1;
                localStorage.setItem("numMovies", numMovies);
        }
        else {
                let numMeals = parseInt(localStorage.getItem("numMeals")) + 1;
                localStorage.setItem("numMeals", numMeals);
        }
}

function startTimer() {
        //https://stackoverflow.com/questions/31559469/how-to-create-a-simple-javascript-timer
        document.getElementById("startButton").disabled = true; //https://www.w3schools.com/jsref/prop_text_readonly.asp
        document.getElementById("stopButton").disabled = false;
        document.getElementById("textbox").readOnly = false; 
        var sec = 40;
        timer = setInterval(function(){
                document.getElementById('timerDisplay').innerHTML='00:'+sec;
                sec--;
                if (sec < 0) {
                        alert("Time's up!");
                        stopTimer();
                }
        }, 1000);
}

function stopTimer() {
        alert("Click on 'View Results'!");
        clearInterval(timer);
        document.getElementById("textbox").readOnly = true;
        document.getElementById("stopButton").disabled = true;
        readInput();
}

function readInput() {

        let textInput = document.getElementById("textbox").value;
        let index = document.getElementById("timerDisplay").innerHTML.indexOf(":");
        let timeLeft = document.getElementById("timerDisplay").innerHTML.substring(index+1);

        let numRounds = localStorage.getItem("numRounds");
        if (numRounds == null) {
                localStorage.setItem("numRounds", 1);
        }
        else {
                numRounds = parseInt(numRounds) + 1;
                localStorage.setItem("numRounds", numRounds);
        }

        calculateResults(textInput, index, timeLeft);
}

function calculateResults(textInput, index, timeLeft) {

        let points = 0;
        let totalPoints = 0;
        let accuracy = 0;
        let wpm = 0;
        let numSpaces = 0;
        let numWords = 0;
        let totalAccuracyStr = "";
        let totalAccuracy = 0;
        let avgAccuracy = 0;
        let totalWpmStr = "";
        let totalWpm = 0;
        let avgWpm = 0;
        textInput = textInput.trim();

        //calculating total points
        totalPoints = sentence.length;
        localStorage.setItem("totalPoints", totalPoints);

        //calculating points earned
        for (let i = 0; i < sentence.length; i++)
        {
                if (sentence.charAt(i) == textInput.charAt(i)) {
                        points++;
                }
        }
        localStorage.setItem("points", points);

        //calculating accuracy
        accuracy = ((points/totalPoints)*100).toFixed(2);
        localStorage.setItem("accuracy", accuracy);

        //calcuating wpm
        if (textInput.length != 0) {
                for (let i = 0; i < textInput.length; i++) {
                        if (textInput.charAt(i) == " ") {
                                numSpaces++;
                        }
                }
                numWords = numSpaces + 1;
        }
        wpm = ( parseInt(numWords) / ((40-parseInt(timeLeft))/60) ).toFixed(3);
        localStorage.setItem("wpm", wpm);

        //calculating avg accuracy
        totalAccuracyStr = localStorage.getItem("totalAccuracy");
        if (totalAccuracyStr == null) {
                totalAccuracy = parseFloat(localStorage.getItem("accuracy"));
                localStorage.setItem("totalAccuracy", totalAccuracy);
        }
        else {
                totalAccuracy = parseFloat(totalAccuracyStr) + parseFloat(localStorage.getItem("accuracy"));
                localStorage.setItem("totalAccuracy", totalAccuracy);
        }
        avgAccuracy = (totalAccuracy/parseInt(localStorage.getItem("numRounds"))).toFixed(2);
        localStorage.setItem("avgAccuracy", avgAccuracy);

        //calculating avg wpm
        totalWpmStr = localStorage.getItem("totalWpm");
        if (totalWpmStr == null) {
                totalWpm = parseFloat(localStorage.getItem("wpm"));
                localStorage.setItem("totalWpm", totalWpm);
        }
        else {
                totalWpm = parseFloat(totalWpmStr) + parseFloat(localStorage.getItem("wpm"));
                localStorage.setItem("totalWpm", totalWpm);
        }
        avgWpm = (totalWpm/parseInt(localStorage.getItem("numRounds"))).toFixed(2);
        localStorage.setItem("avgWpm", avgWpm);

        //finding preferred category
        let numMontaVista = parseInt(localStorage.getItem("numMontaVista"));
        let numMusic = parseInt(localStorage.getItem("numMusic"));
        let numMovies = parseInt(localStorage.getItem("numMovies"));
        let numMeals = parseInt(localStorage.getItem("numMeals"));
        let prefCatNum = Math.max(numMontaVista, numMusic, numMovies, numMeals);
        let prefCat = "";
        if (prefCatNum == numMontaVista) {
                prefCat = "Monta Vista";
        }
        else if (prefCatNum == numMusic) {
                prefCat = "Music";
        }
        else if (prefCatNum == numMovies) {
                prefCat = "Movies";
        }
        else {
                prefCat = "Meals";
        }
        localStorage.setItem("preferredCategory", prefCat);
}

function displayResults() {
        document.getElementById("resultspoints").innerHTML += " " + localStorage.getItem("points") + "/" + localStorage.getItem("totalPoints");
        document.getElementById("resultsaccuracy").innerHTML += " " + localStorage.getItem("accuracy") + "%";
        document.getElementById("resultswpm").innerHTML += " " + localStorage.getItem("wpm");
}

function displayStats() {
        document.getElementById("statsnumrounds").innerHTML += " " + localStorage.getItem("numRounds");
        document.getElementById("statsavgaccuracy").innerHTML += " " + localStorage.getItem("avgAccuracy") + "%";
        document.getElementById("statsavgwpm").innerHTML += " " + localStorage.getItem("avgWpm");
        document.getElementById("statsprefcategory").innerHTML += " " + localStorage.getItem("preferredCategory");
}

function resetStats() {
        // Clear local storage when the user wants to reset stats
        alert("Resetting Stats");
        //https://www.edureka.co/community/71981/delete-localstorage-item-when-the-browser-window-tab-closed
        localStorage.removeItem("numRounds");
        localStorage.removeItem("totalAccuracy");
        localStorage.removeItem("avgAccuracy");
        localStorage.removeItem("totalWpm");
        localStorage.removeItem("avgWpm");
        //setting the number of times each category is played to 0
        localStorage.setItem("numMontaVista", 0);
        localStorage.setItem("numMusic", 0);
        localStorage.setItem("numMovies", 0);
        localStorage.setItem("numMeals", 0);
        goToNextPage("index.html");
}



